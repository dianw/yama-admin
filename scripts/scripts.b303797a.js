(function(){var a,h,k,e,g,f,c;c=function(){return function(){return"angular-loading-bar angularPopupBoxes ngAnimate ngCookies ngResource ngRoute ngSanitize ngTouch oauth restangular ui.bootstrap ui.router ui.select validation validation.rule validation.schema".split(" ")}}();e=function(){return function(b,d,c){b.hashPrefix("!");d.otherwise("/");c.strictMode(!1)}}();h=function(){return function(b){b.setDefaultHttpFields({cache:!1});b.addResponseInterceptor(function(d,b){var c;"getList"===b&&angular.isObject(d)?
(c=angular.copy(d.content,c),delete d.content,c.meta=d):c=d;return c})}}();f=function(){return function(b){b.showSuccessMessage=!1;b.invalidCallback=function(b){return $(b).parents(".form-group:first").addClass("has-error")};b.validCallback=function(b){return $(b).parents(".form-group:first").removeClass("has-error")};b.setExpression({match:function(b,c,a,g,k){return b===$(k).val()},alphanumeric:/^[a-z0-9]+$/i});b.setErrorHTML(function(b){return'<p class="text-danger">'+b+"</p>"});b.setSuccessHTML(function(b){return'<p class="text-success">'+
b+"</p>"})}}();g=function(){return function(b,d){b.setExpression({userexist:function(b){return d.one(b).get().then(function(b){return!b},function(){return!0})}})}}();k=function(){return function(b){b.theme="bootstrap";b.resetSearchInput=!0}}();a=function(){return function(b,d,c){b.$state={};d.isAuthorized()?b.currentUser||c.one("me").get().then(function(c){return b.currentUser=c}):d.login();b.$on("oauth:unauthorized",function(){return d.login()});b.$on("oauth:logout",function(){return d.login()});
b.$on("$stateChangeStart",function(c,a,g){if(!d.isAuthorized())return c.preventDefault(),b.$state.toState=a,b.$state.toState.params=g,d.login()})}}();angular.module("yamaAdminApp",new c).config(["$locationProvider","$urlRouterProvider","$urlMatcherFactoryProvider",e]).config(["RestangularProvider",h]).config(["$validationProvider",f]).run(["$validation","RestUserService",g]).config(["uiSelectConfig",k]).run(["$rootScope","oauth","RestUserService",a])}).call(this);
(function(){var a;a=function(){return function(a){this.menus=[{menu:"Users",icon:"user",ref:"app.admin.user"},{menu:"Roles",icon:"users",ref:"app.admin.role"},{menu:"Applications",icon:"desktop",ref:"app.admin.application"}];this.state=a;this.state.go(this.menus[0].ref)}}();angular.module("yamaAdminApp").controller("adminController",["$state",a]);"use strict";a=function(){return function(a){a.state("app.admin",{url:"admin",templateUrl:"admin/admin.html",controller:"adminController as ctrl"})}}();
angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a,h;a=function(){return function(a,e,g,f){var c;c=this;c.searchParams=e.search();c.searchParams.hash=0;c.page=1;this.search=function(){c.searchParams.hash++;c.searchParams.page=c.page-1;e.search(c.searchParams);return g.getList(c.searchParams).then(function(b){c.applications=b;return c.page=b.meta.number+1})};this.search();this.openForm=function(b,d){return a.open({templateUrl:"admin/application/application.form.html",controller:"applicationFormController as ctrl",size:"md",resolve:{application:function(){return b},
changeSecret:function(){return d}}}).result.then(function(b){c.searchParams.q=b.name;return c.search()})};this.remove=function(b){return f.confirm("Are you sure want to delete this data?").result.then(function(){return b.remove().then(function(){return c.search(c.searchParams)})})}}}();h=function(){return function(a,e,g,f,c){var b,d,l;b=this;b.changeSecret=c||!1;f&&(f.redirectUri=f.registeredRedirectUris[0],b.application=f);l=function(b){return a.close(b)};d=function(){return b.error=!0};this.submit=
function(c,a){return e.validate(a).success(function(){c.registeredRedirectUris=[];c.registeredRedirectUris.push(c.redirectUri);b.error=!1;return c.id?c.put().then(l,d):g.post(c).then(l,d)})};this.generateSecret=function(c){return c.post("secret").then(function(c){return b.application.secret=c.secret},d)}}}();angular.module("yamaAdminApp").controller("applicationController",["$modal","$location","RestApplicationService","angularPopupBoxes",a]).controller("applicationFormController",["$modalInstance",
"$validation","RestApplicationService","application","changeSecret",h]);"use strict";a=function(){return function(a){a.state("app.admin.application",{url:"/applications",templateUrl:"admin/application/application.list.html",controller:"applicationController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("applications")}}();angular.module("yamaAdminApp").factory("RestApplicationService",["Restangular",a]);"use strict";
a=function(){return function(a){a.set("application",{name:{validations:"required","validate-on":"blur",messages:{required:{error:"Name cannot be blank",success:"Ok"}}},website:{validations:"url, required","validate-on":"blur",messages:{required:{error:"Site cannot be blank",success:"Ok"},url:{error:"Not a valid URL",success:"Ok"}}},redirect:{validations:"url, required","validate-on":"blur",messages:{required:{error:"Site cannot be blank",success:"Ok"},url:{error:"Not a valid URL",success:"Ok"}}}})}}();
angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a,h;a=function(){return function(a,e,g,f){var c;c=this;c.searchParams=e.search();c.searchParams.hash=0;c.page=1;this.search=function(){c.searchParams.hash++;c.searchParams.page=c.page-1;e.search(c.searchParams);return g.getList(c.searchParams).then(function(b){c.roles=b;return c.page=b.meta.number+1})};this.search();this.openForm=function(b){return a.open({templateUrl:"admin/role/role.form.html",controller:"roleFormController as ctrl",size:"md",resolve:{role:function(){return b||{}}}}).result.then(function(b){c.searchParams.q=
b.name;return c.search()})};this.remove=function(b){return f.confirm("Are you sure want to delete this data?").result.then(function(){return b.remove().then(function(){return c.search(c.searchParams)})})}}}();h=function(){return function(a,e,g,f){var c,b,d;c=this;c.role=f;d=function(b){return a.close(b)};b=function(){return c.error=!0};this.submit=function(a,f){return e.validate(f).success(function(){c.error=!1;return a.id?a.put().then(d,b):g.post(a).then(d,b)})}}}();angular.module("yamaAdminApp").controller("roleController",
["$modal","$location","RestRoleService","angularPopupBoxes",a]).controller("roleFormController",["$modalInstance","$validation","RestRoleService","role",h]);"use strict";a=function(){return function(a){a.state("app.admin.role",{url:"/roles",templateUrl:"admin/role/role.list.html",controller:"roleController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("roles")}}();angular.module("yamaAdminApp").factory("RestRoleService",
["Restangular",a]);"use strict";a=function(){return function(a){a.set("role",{name:{validations:"required, minlength=4","validate-on":"blur",messages:{required:{error:"Name cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 3 character",success:"Ok"}}}})}}();angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a,h,k,e;a=function(){return function(a,f,c,b){var d;d=this;d.searchParams=f.search();d.searchParams.hash=0;d.page=1;this.search=function(){d.searchParams.hash++;d.searchParams.page=d.page-1;f.search(d.searchParams);return c.getList(d.searchParams).then(function(b){var a,c,g,f,e;d.users=b;d.page=b.meta.number+1;a=function(b){return b.getList("roles").then(function(a){return b.roles=a})};e=[];g=0;for(f=b.length;g<f;g++)c=b[g],e.push(a(c));return e})};this.search();this.openForm=function(b){return a.open({templateUrl:"admin/user/user.form.html",
controller:"userFormController as ctrl",size:"md",resolve:{user:function(){return b||{}}}}).result.then(function(b){d.searchParams.q=b.username;return d.search()})};this.changePasswd=function(b){return a.open({templateUrl:"admin/user/user.passwd.html",controller:"userChangePasswdFormController as ctrl",size:"md",resolve:{user:function(){return b}}}).result.then(function(){return d.search()})};this.addRole=function(b){return a.open({templateUrl:"admin/user/user.role.html",controller:"userEditRoleFormController as ctrl",
size:"md",resolve:{user:function(){return b}}}).result.then(function(){return d.search(d.searchParams)})};this.remove=function(a){return b.confirm("Are you sure want to delete this data?").result.then(function(){return a.remove().then(function(){return d.search(d.searchParams)})})}}}();e=function(){return function(a,f,c,b){var d,e,h;d=this;d.roles=[];if(d.user=b)b.confirmPassword=b.password;h=function(b){return a.close(b)};e=function(){return d.error=!0};this.submit=function(b,a){return f.validate(a).success(function(){d.error=
!1;return b.id?b.put().then(h,e):c.post(b).then(h,e)})}}}();h=function(){return function(a,f,c){var b;c.password="";b=this;b.user=c;this.submit=function(c,e){return f.validate(e).success(function(){b.error=!1;return c.post("password").then(function(){return a.close()},function(){return b.error=!0})})}}}();k=function(){return function(a,f,c,b){var d,e;d=this;d.user=b;d.roles=[];e=function(){return f.get("$http").remove(b.one("roles").getRequestedUrl())};this.loadRoles=function(b){return c.getList({q:b}).then(function(b){return d.roles=
b})};this.addRole=function(a){return b.one("roles",a.id).put().then(e)};this.removeRole=function(a){return b.one("roles",a.id).remove().then(e)};this.done=a.close}}();angular.module("yamaAdminApp").controller("userController",["$modal","$location","RestUserService","angularPopupBoxes",a]).controller("userFormController",["$modalInstance","$validation","RestUserService","user",e]).controller("userChangePasswdFormController",["$modalInstance","$validation","user",h]).controller("userEditRoleFormController",
["$modalInstance","$cacheFactory","RestRoleService","user",k]);"use strict";a=function(){return function(a){a.state("app.admin.user",{url:"/users",templateUrl:"admin/user/user.list.html",controller:"userController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("users")}}();angular.module("yamaAdminApp").factory("RestUserService",["Restangular",a]);"use strict";a=function(){return function(a){a.set("user",{username:{validations:"required, minlength=6, userexist, alphanumeric",
"validate-on":"blur",messages:{required:{error:"Username cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 5 character",success:"Ok"},userexist:{error:"Username already exist",success:"Ok"},alphanumeric:{error:"Only alphanumeric are allowed",success:"Ok"}}},passwd:{validations:"required","validate-on":"blur",messages:{required:{error:"Password cannot be blank",success:"Ok"}}},confpasswd:{validations:'match=[name="passwd"]',"validate-on":"blur",messages:{match:{error:"Password and confirm password did not match",
success:"Ok"}}},firstname:{validations:"required","validate-on":"blur",messages:{required:{error:"First name cannot be blank",success:"Ok"}}},lastname:{validations:"required","validate-on":"blur",messages:{required:{error:"Last name cannot be blank",success:"Ok"}}},email:{validations:"required, email, userexist","validate-on":"blur",messages:{required:{error:"First name cannot be blank",success:"Ok"},email:{error:"Not a valid email address",success:"Ok"},userexist:{error:"Email address already exist",
success:"Ok"}}}});a.set("passwd",{passwd:{validations:"required, minlength=6","validate-on":"blur",messages:{required:{error:"Password cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 5 character",success:"Ok"}}},confpasswd:{validations:'match=[name="passwd"]',"validate-on":"blur",messages:{match:{error:"Password and confirm password did not match",success:"Ok"}}}})}}();angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a;a=function(){return function(a,k,e){a.go("app.admin")}}();angular.module("yamaAdminApp").controller("appController",["$state","$rootScope","$timeout",a]);"use strict";a=function(){return function(a){a.state("app",{url:"/",templateUrl:"app/app.html",controller:"appController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a,h;h=function(){return function(a,e,g){return{request:function(a){g.get()&&(a.headers.Authorization="Bearer "+g.get().access_token);return a},responseError:function(f){401===f.status&&a.$broadcast("oauth:unauthorized",f);return e.reject(f)}}}}();a=function(){return function(a){a.interceptors.push("OauthInterceptor")}}();angular.module("yamaAdminApp").factory("OauthInterceptor",["$rootScope","$q","AccessToken",h]).config(["$httpProvider",a]);"use strict";a=function(){return function(){var a,
e,g,f,c,b,d,h;b=c=g=f=e=a=null;d={clientId:"",redirectUri:location.protocol+"//"+location.host,site:location.protocol+"//"+location.host,authorizePath:"/oauth/authorize",tokenPath:"/oauth/token",responseType:"token",state:null,scope:null,storage:"sessionStorage"};h=function(d){a=d.get("$rootScope");e=d.get("$timeout");f=d.get("Endpoint");g=d.get("AccessToken");c=d.get("Storage");c.use(b.storage);f.set(b);g.set(b);return a.$on("oauth:expired",function(){return g.destroy()})};this.configure=function(a){if(!(a instanceof
Object))throw new TypeError("Config must be object");return b=angular.extend({},d,a)};this.login=function(){g.destroy();return f.redirect()};this.logout=function(){g.destroy();return e(function(){return a.$broadcast("oauth:logout")},500)};this.isAuthorized=function(){return!(null===g.get()||g.expired())};this.getAccessToken=function(){return g.get()};this.isExpired=function(){return g.expired()};this.$get=["$injector",function(a){h(a);return{login:this.login,logout:this.logout,isAuthorized:this.isAuthorized,
getAccessToken:this.getAccessToken,isExpired:this.isExpired}}]}}();angular.module("yamaAdminApp").provider("oauth",[a])}).call(this);
(function(){var a,h;a=function(){return function(a){a.configure({site:"http://yama2.meruvian.org",scope:"read write",clientId:"ca4bde63-9a81-4202-b869-69041f5d9217",redirectUri:"http://dianw.github.io/yama-admin"})}}();h=function(){return function(a){a.setBaseUrl("http://yama2.meruvian.org/api")}}();angular.module("yamaAdminApp").config(["oauthProvider",a]).config(["RestangularProvider",h])}).call(this);

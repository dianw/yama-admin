(function(){var a,e,k,l,f,g,d;d=function(){return function(){return"angular-loading-bar angularPopupBoxes ngAnimate ngCookies ngResource ngRoute ngSanitize ngTouch oauth restangular ui.bootstrap ui.router ui.select validation validation.rule validation.schema".split(" ")}}();l=function(){return function(c,b,m){c.hashPrefix("!");b.otherwise("/");m.strictMode(!1)}}();e=function(){return function(c){c.setDefaultHttpFields({cache:!1});c.addResponseInterceptor(function(b,c){var h;"getList"===c&&angular.isObject(b)?
(h=angular.copy(b.content,h),delete b.content,h.meta=b):h=b;return h})}}();g=function(){return function(c){c.showSuccessMessage=!1;c.invalidCallback=function(b){return $(b).parents(".form-group:first").addClass("has-error")};c.validCallback=function(b){return $(b).parents(".form-group:first").removeClass("has-error")};c.setExpression({match:function(b,c,h,a,f){return b===$(f).val()},alphanumeric:/^[a-z0-9]+$/i});c.setErrorHTML(function(b){return'<p class="text-danger">'+b+"</p>"});c.setSuccessHTML(function(b){return'<p class="text-success">'+
b+"</p>"})}}();f=function(){return function(c,b){c.setExpression({userexist:function(c){return b.one(c).get().then(function(b){return!b},function(){return!0})}})}}();k=function(){return function(c){c.theme="bootstrap";c.resetSearchInput=!0}}();a=function(){return function(c,b,a){c.$state={};b.isAuthorized()?c.currentUser||a.one("me").get().then(function(b){return c.currentUser=b}):b.login();c.$on("oauth:unauthorized",function(){return b.login()});c.$on("oauth:logout",function(){return b.login()});
c.$on("$stateChangeStart",function(a,f,d){if(!b.isAuthorized())return a.preventDefault(),c.$state.toState=f,c.$state.toState.params=d,b.login()})}}();angular.module("yamaAdminApp",new d).config(["$locationProvider","$urlRouterProvider","$urlMatcherFactoryProvider",l]).config(["RestangularProvider",e]).config(["$validationProvider",g]).run(["$validation","RestUserService",f]).config(["uiSelectConfig",k]).run(["$rootScope","oauth","RestUserService",a])}).call(this);
(function(){var a;a=function(){return function(a){this.menus=[{menu:"Users",icon:"user",ref:"app.admin.user"},{menu:"Roles",icon:"users",ref:"app.admin.role"}];this.state=a;this.state.go(this.menus[0].ref)}}();angular.module("yamaAdminApp").controller("adminController",["$state",a]);"use strict";a=function(){return function(a){a.state("app.admin",{url:"admin",templateUrl:"admin/admin.html",controller:"adminController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a,e;a=function(){return function(a,e,f,g){var d;d=this;d.searchParams=e.search();d.searchParams.hash=0;d.page=1;this.search=function(){d.searchParams.hash++;d.searchParams.page=d.page-1;e.search(d.searchParams);return f.getList(d.searchParams).then(function(c){d.roles=c;return d.page=c.meta.number+1})};this.search();this.openForm=function(c){return a.open({templateUrl:"admin/role/role.form.html",controller:"roleFormController as ctrl",size:"md",resolve:{role:function(){return c||{}}}}).result.then(function(b){d.searchParams.q=
b.name;return d.search()})};this.remove=function(c){return g.confirm("Are you sure want to delete this data?").result.then(function(){return c.remove().then(function(){return d.search(d.searchParams)})})}}}();e=function(){return function(a,e,f,g){var d,c,b;d=this;d.role=g;b=function(b){return a.close(b)};c=function(){return d.error=!0};this.submit=function(a,h){return e.validate(h).success(function(){d.error=!1;return a.id?a.put().then(b,c):f.post(a).then(b,c)})}}}();angular.module("yamaAdminApp").controller("roleController",
["$modal","$location","RestRoleService","angularPopupBoxes",a]).controller("roleFormController",["$modalInstance","$validation","RestRoleService","role",e]);"use strict";a=function(){return function(a){a.state("app.admin.role",{url:"/role",templateUrl:"admin/role/role.list.html",controller:"roleController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("roles")}}();angular.module("yamaAdminApp").factory("RestRoleService",
["Restangular",a]);"use strict";a=function(){return function(a){a.set("role",{name:{validations:"required, minlength=4","validate-on":"blur",messages:{required:{error:"Name cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 3 character",success:"Ok"}}}})}}();angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a,e,k,l;a=function(){return function(a,g,d,c){var b;b=this;b.searchParams=g.search();b.searchParams.hash=0;b.page=1;this.search=function(){b.searchParams.hash++;b.searchParams.page=b.page-1;g.search(b.searchParams);return d.getList(b.searchParams).then(function(a){var c,d,f,g,e;b.users=a;b.page=a.meta.number+1;c=function(b){return b.getList("roles").then(function(a){return b.roles=a})};e=[];f=0;for(g=a.length;f<g;f++)d=a[f],e.push(c(d));return e})};this.search();this.openForm=function(c){return a.open({templateUrl:"admin/user/user.form.html",
controller:"userFormController as ctrl",size:"md",resolve:{user:function(){return c||{}}}}).result.then(function(a){b.searchParams.q=a.username;return b.search()})};this.changePasswd=function(c){return a.open({templateUrl:"admin/user/user.passwd.html",controller:"userChangePasswdFormController as ctrl",size:"md",resolve:{user:function(){return c}}}).result.then(function(){return b.search()})};this.addRole=function(c){return a.open({templateUrl:"admin/user/user.role.html",controller:"userEditRoleFormController as ctrl",
size:"md",resolve:{user:function(){return c}}}).result.then(function(){return b.search(b.searchParams)})};this.remove=function(a){return c.confirm("Are you sure want to delete this data?").result.then(function(){return a.remove().then(function(){return b.search(b.searchParams)})})}}}();l=function(){return function(a,g,d,c){var b,e,h;b=this;b.roles=[];if(b.user=c)c.confirmPassword=c.password;h=function(b){return a.close(b)};e=function(){return b.error=!0};this.submit=function(a,c){return g.validate(c).success(function(){b.error=
!1;return a.id?a.put().then(h,e):d.post(a).then(h,e)})}}}();e=function(){return function(a,e,d){var c;d.password="";c=this;c.user=d;this.submit=function(b,d){return e.validate(d).success(function(){c.error=!1;return b.post("password").then(function(){return a.close()},function(){return c.error=!0})})}}}();k=function(){return function(a,e,d,c){var b,k;b=this;b.user=c;b.roles=[];k=function(){return e.get("$http").remove(c.one("roles").getRequestedUrl())};this.loadRoles=function(a){return d.getList({q:a}).then(function(a){return b.roles=
a})};this.addRole=function(a){return c.one("roles",a.id).put().then(k)};this.removeRole=function(a){return c.one("roles",a.id).remove().then(k)};this.done=a.close}}();angular.module("yamaAdminApp").controller("userController",["$modal","$location","RestUserService","angularPopupBoxes",a]).controller("userFormController",["$modalInstance","$validation","RestUserService","user",l]).controller("userChangePasswdFormController",["$modalInstance","$validation","user",e]).controller("userEditRoleFormController",
["$modalInstance","$cacheFactory","RestRoleService","user",k]);"use strict";a=function(){return function(a){a.state("app.admin.user",{url:"/user",templateUrl:"admin/user/user.list.html",controller:"userController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("users")}}();angular.module("yamaAdminApp").factory("RestUserService",["Restangular",a]);"use strict";a=function(){return function(a){a.set("user",{username:{validations:"required, minlength=6, userexist, alphanumeric",
"validate-on":"blur",messages:{required:{error:"Username cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 5 character",success:"Ok"},userexist:{error:"Username already exist",success:"Ok"},alphanumeric:{error:"Only alphanumeric are allowed",success:"Ok"}}},passwd:{validations:"required","validate-on":"blur",messages:{required:{error:"Password cannot be blank",success:"Ok"}}},confpasswd:{validations:'match=[name="passwd"]',"validate-on":"blur",messages:{match:{error:"Password and confirm password did not match",
success:"Ok"}}},firstname:{validations:"required","validate-on":"blur",messages:{required:{error:"First name cannot be blank",success:"Ok"}}},lastname:{validations:"required","validate-on":"blur",messages:{required:{error:"Last name cannot be blank",success:"Ok"}}},email:{validations:"required, email, userexist","validate-on":"blur",messages:{required:{error:"First name cannot be blank",success:"Ok"},email:{error:"Not a valid email address",success:"Ok"},userexist:{error:"Email address already exist",
success:"Ok"}}}});a.set("passwd",{passwd:{validations:"required, minlength=6","validate-on":"blur",messages:{required:{error:"Password cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 5 character",success:"Ok"}}},confpasswd:{validations:'match=[name="passwd"]',"validate-on":"blur",messages:{match:{error:"Password and confirm password did not match",success:"Ok"}}}})}}();angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a;a=function(){return function(a,k,l){a.go("app.admin")}}();angular.module("yamaAdminApp").controller("appController",["$state","$rootScope","$timeout",a]);"use strict";a=function(){return function(a){a.state("app",{url:"/",templateUrl:"app/app.html",controller:"appController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a,e;e=function(){return function(a,e,f){return{request:function(a){f.get()&&(a.headers.Authorization="Bearer "+f.get().access_token);return a},responseError:function(f){401===f.status&&a.$broadcast("oauth:unauthorized",f);return e.reject(f)}}}}();a=function(){return function(a){a.interceptors.push("OauthInterceptor")}}();angular.module("yamaAdminApp").factory("OauthInterceptor",["$rootScope","$q","AccessToken",e]).config(["$httpProvider",a]);"use strict";a=function(){return function(){var a,
e,f,g,d,c,b,m;c=d=f=g=e=a=null;b={clientId:"",redirectUri:location.protocol+"//"+location.host,site:location.protocol+"//"+location.host,authorizePath:"/oauth/authorize",tokenPath:"/oauth/token",responseType:"token",state:null,scope:null,storage:"sessionStorage"};m=function(b){a=b.get("$rootScope");e=b.get("$timeout");g=b.get("Endpoint");f=b.get("AccessToken");d=b.get("Storage");d.use(c.storage);g.set(c);f.set(c);return a.$on("oauth:expired",function(){return f.destroy()})};this.configure=function(a){if(!(a instanceof
Object))throw new TypeError("Config must be object");return c=angular.extend({},b,a)};this.login=function(){f.destroy();return g.redirect()};this.logout=function(){f.destroy();return e(function(){return a.$broadcast("oauth:logout")},500)};this.isAuthorized=function(){return!(null===f.get()||f.expired())};this.getAccessToken=function(){return f.get()};this.isExpired=function(){return f.expired()};this.$get=["$injector",function(a){m(a);return{login:this.login,logout:this.logout,isAuthorized:this.isAuthorized,
getAccessToken:this.getAccessToken,isExpired:this.isExpired}}]}}();angular.module("yamaAdminApp").provider("oauth",[a])}).call(this);
(function(){var a,e;a=function(){return function(a){a.configure({site:"http://yama2.meruvian.org",scope:"read write",clientId:"ca4bde63-9a81-4202-b869-69041f5d9217",redirectUri:"http://dianw.github.io/yama-admin"})}}();e=function(){return function(a){a.setBaseUrl("http://yama2.meruvian.org/api")}}();angular.module("yamaAdminApp").config(["oauthProvider",a]).config(["RestangularProvider",e])}).call(this);

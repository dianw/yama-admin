(function(){var a,f,h,k,d,g,c,e;e=function(){return function(){return"angular-loading-bar angularPopupBoxes ngAnimate ngCookies ngFileUpload ngResource ngRoute ngSanitize ngTouch oauth restangular ui.bootstrap ui.router ui.select validation validation.rule validation.schema".split(" ")}}();d=function(){return function(b,l,a){b.hashPrefix("!");l.otherwise("/");a.strictMode(!1)}}();h=function(){return function(b){b.setDefaultHttpFields({cache:!1});b.addResponseInterceptor(function(b,a){var c;"getList"===
a&&angular.isObject(b)?(c=angular.copy(b.content,c),delete b.content,c.meta=b):c=b;return c})}}();c=function(){return function(b){b.showSuccessMessage=!1;b.invalidCallback=function(b){return $(b).parents(".form-group:first").addClass("has-error")};b.validCallback=function(b){return $(b).parents(".form-group:first").removeClass("has-error")};b.setExpression({match:function(b,a,c,e,d){return b===$(d).val()},alphanumeric:/^[a-z0-9]+$/i});b.setErrorHTML(function(b){return'<p class="text-danger">'+b+"</p>"});
b.setSuccessHTML(function(b){return'<p class="text-success">'+b+"</p>"})}}();g=function(){return function(b,a){b.setExpression({userexist:function(b,c,e,d,h){return d.exclude===b?!0:a.one(b).get().then(function(b){return!b},function(){return!0})}})}}();k=function(){return function(b){b.theme="bootstrap";b.resetSearchInput=!0}}();a=function(){return function(b,a,c){b.$state={};a.isAuthorized()?b.currentUser||c.one("me").get().then(function(a){return b.currentUser=a}):a.login();b.$on("oauth:unauthorized",
function(){return a.login()});b.$on("oauth:logout",function(){return a.login()});b.$on("$stateChangeStart",function(c,e,d){if(!a.isAuthorized())return c.preventDefault(),b.$state.toState=e,b.$state.toState.params=d,a.login()})}}();f=function(){return function(b){return{restrict:"A",link:function(a,c,e){c.height(c.width());return b(function(){return c.imgLiquid({fill:!0,horizontalAlign:"center",verticalAlign:"50%"})})}}}}();angular.module("yamaAdminApp",new e).config(["$locationProvider","$urlRouterProvider",
"$urlMatcherFactoryProvider",d]).config(["RestangularProvider",h]).config(["$validationProvider",c]).run(["$validation","RestUserService",g]).config(["uiSelectConfig",k]).run(["$rootScope","oauth","RestUserService",a]).directive("imgLiquid",["$timeout",f])}).call(this);
(function(){var a;a=function(){return function(a){this.menus=[{menu:"Users",icon:"user",ref:"app.admin.user"},{menu:"Roles",icon:"users",ref:"app.admin.role"},{menu:"Applications",icon:"desktop",ref:"app.admin.application"}];this.state=a;this.state.go(this.menus[0].ref)}}();angular.module("yamaAdminApp").controller("adminController",["$state",a]);"use strict";a=function(){return function(a){a.state("app.admin",{url:"admin",templateUrl:"admin/admin.html",controller:"adminController as ctrl"})}}();
angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a,f;a=function(){return function(a,f,d,g){var c;c=this;c.searchParams=f.search();c.searchParams.hash=0;c.page=1;this.search=function(){c.searchParams.hash++;c.searchParams.page=c.page-1;f.search(c.searchParams);return d.getList(c.searchParams).then(function(a){c.applications=a;return c.page=a.meta.number+1})};this.search();this.openForm=function(e,b){return a.open({templateUrl:"admin/application/application.form.html",controller:"applicationFormController as ctrl",size:"md",resolve:{application:function(){return e},
changeSecret:function(){return b}}}).result.then(function(b){c.searchParams.q=b.name;return c.search()})};this.remove=function(a){return g.confirm("Are you sure want to delete this data?").result.then(function(){return a.remove().then(function(){return c.search(c.searchParams)})})}}}();f=function(){return function(a,f,d,g,c){var e,b,l;e=this;e.changeSecret=c||!1;g&&(g.redirectUri=g.registeredRedirectUris[0],e.application=g);l=function(b){return a.close(b)};b=function(){return e.error=!0};this.submit=
function(a,c){return f.validate(c).success(function(){a.registeredRedirectUris=[];a.registeredRedirectUris.push(a.redirectUri);e.error=!1;return a.id?a.put().then(l,b):d.post(a).then(l,b)})};this.generateSecret=function(a){return a.post("secret").then(function(a){return e.application.secret=a.secret},b)}}}();angular.module("yamaAdminApp").controller("applicationController",["$modal","$location","RestApplicationService","angularPopupBoxes",a]).controller("applicationFormController",["$modalInstance",
"$validation","RestApplicationService","application","changeSecret",f]);"use strict";a=function(){return function(a){a.state("app.admin.application",{url:"/applications",templateUrl:"admin/application/application.list.html",controller:"applicationController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("applications")}}();angular.module("yamaAdminApp").factory("RestApplicationService",["Restangular",a]);"use strict";
a=function(){return function(a){a.set("application",{name:{validations:"required","validate-on":"blur",messages:{required:{error:"Name cannot be blank",success:"Ok"}}},website:{validations:"url, required","validate-on":"blur",messages:{required:{error:"Site cannot be blank",success:"Ok"},url:{error:"Not a valid URL",success:"Ok"}}},redirect:{validations:"url, required","validate-on":"blur",messages:{required:{error:"Site cannot be blank",success:"Ok"},url:{error:"Not a valid URL",success:"Ok"}}}})}}();
angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a,f;a=function(){return function(a,f,d,g){var c;c=this;c.searchParams=f.search();c.searchParams.hash=0;c.page=1;this.search=function(){c.searchParams.hash++;c.searchParams.page=c.page-1;f.search(c.searchParams);return d.getList(c.searchParams).then(function(a){c.roles=a;return c.page=a.meta.number+1})};this.search();this.openForm=function(d){return a.open({templateUrl:"admin/role/role.form.html",controller:"roleFormController as ctrl",size:"md",resolve:{role:function(){return d||{}}}}).result.then(function(a){c.searchParams.q=
a.name;return c.search()})};this.remove=function(a){return g.confirm("Are you sure want to delete this data?").result.then(function(){return a.remove().then(function(){return c.search(c.searchParams)})})}}}();f=function(){return function(a,f,d,g){var c,e,b;c=this;c.role=g;b=function(b){return a.close(b)};e=function(){return c.error=!0};this.submit=function(a,g){return f.validate(g).success(function(){c.error=!1;return a.id?a.put().then(b,e):d.post(a).then(b,e)})}}}();angular.module("yamaAdminApp").controller("roleController",
["$modal","$location","RestRoleService","angularPopupBoxes",a]).controller("roleFormController",["$modalInstance","$validation","RestRoleService","role",f]);"use strict";a=function(){return function(a){a.state("app.admin.role",{url:"/roles",templateUrl:"admin/role/role.list.html",controller:"roleController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("roles")}}();angular.module("yamaAdminApp").factory("RestRoleService",
["Restangular",a]);"use strict";a=function(){return function(a){a.set("role",{name:{validations:"required, minlength=4","validate-on":"blur",messages:{required:{error:"Name cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 3 character",success:"Ok"}}}})}}();angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a,f,h,k;a=function(){return function(a,f,c,e){var b;b=this;b.searchParams=f.search();b.searchParams.hash=0;b.page=1;this.search=function(){b.searchParams.hash++;b.searchParams.page=b.page-1;f.search(b.searchParams);return c.getList(b.searchParams).then(function(a){var c,d,f,e,g;b.users=a;b.page=a.meta.number+1;c=function(a){return a.getList("roles").then(function(b){return a.roles=b})};g=[];f=0;for(e=a.length;f<e;f++)d=a[f],g.push(c(d));return g})};this.search();this.openForm=function(c){return a.open({templateUrl:"admin/user/user.form.html",
controller:"userFormController as ctrl",size:"md",resolve:{user:function(){return c||{}}}}).result.then(function(a){b.searchParams.q=a.username;return b.search()})};this.changePasswd=function(c){return a.open({templateUrl:"admin/user/user.passwd.html",controller:"userChangePasswdFormController as ctrl",size:"md",resolve:{user:function(){return c}}}).result.then(function(){return b.search()})};this.addRole=function(c){return a.open({templateUrl:"admin/user/user.role.html",controller:"userEditRoleFormController as ctrl",
size:"md",resolve:{user:function(){return c}}}).result.then(function(){return b.search(b.searchParams)})};this.remove=function(a){return e.confirm("Are you sure want to delete this data?").result.then(function(){return a.remove().then(function(){return b.search(b.searchParams)})})}}}();k=function(){return function(a,f,c,e){var b,h,m;b=this;b.roles=[];if(b.user=e)e.confirmPassword=e.password;m=function(b){return a.close(b)};h=function(){return b.error=!0};this.submit=function(a,d){return f.validate(d).success(function(){b.error=
!1;return a.id?a.put().then(m,h):c.post(a).then(m,h)})}}}();f=function(){return function(a,f,c){var e;c.password="";e=this;e.user=c;this.submit=function(b,c){return f.validate(c).success(function(){e.error=!1;return b.post("password").then(function(){return a.close()},function(){return e.error=!0})})}}}();h=function(){return function(a,f,c,e){var b,h;b=this;b.user=e;b.roles=[];h=function(){return f.get("$http").remove(e.one("roles").getRequestedUrl())};this.loadRoles=function(a){return c.getList({q:a}).then(function(a){return b.roles=
a})};this.addRole=function(a){return e.one("roles",a.id).put().then(h)};this.removeRole=function(a){return e.one("roles",a.id).remove().then(h)};this.done=a.close}}();angular.module("yamaAdminApp").controller("userController",["$modal","$location","RestUserService","angularPopupBoxes",a]).controller("userFormController",["$modalInstance","$validation","RestUserService","user",k]).controller("userChangePasswdFormController",["$modalInstance","$validation","user",f]).controller("userEditRoleFormController",
["$modalInstance","$cacheFactory","RestRoleService","user",h]);"use strict";a=function(){return function(a){a.state("app.admin.user",{url:"/users",templateUrl:"admin/user/user.list.html",controller:"userController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a){return a.service("users")}}();angular.module("yamaAdminApp").factory("RestUserService",["Restangular",a]);"use strict";a=function(){return function(a){a.set("user",{username:{validations:"required, minlength=6, userexist, alphanumeric",
"validate-on":"blur",messages:{required:{error:"Username cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 5 character",success:"Ok"},userexist:{error:"Username already exist",success:"Ok"},alphanumeric:{error:"Only alphanumeric are allowed",success:"Ok"}}},passwd:{validations:"required","validate-on":"blur",messages:{required:{error:"Password cannot be blank",success:"Ok"}}},confpasswd:{validations:'match=[name="passwd"]',"validate-on":"blur",messages:{match:{error:"Password and confirm password did not match",
success:"Ok"}}},firstname:{validations:"required","validate-on":"blur",messages:{required:{error:"First name cannot be blank",success:"Ok"}}},lastname:{validations:"required","validate-on":"blur",messages:{required:{error:"Last name cannot be blank",success:"Ok"}}},email:{validations:"required, email, userexist","validate-on":"blur",messages:{required:{error:"First name cannot be blank",success:"Ok"},email:{error:"Not a valid email address",success:"Ok"},userexist:{error:"Email address already exist",
success:"Ok"}}}});a.set("passwd",{passwd:{validations:"required, minlength=6","validate-on":"blur",messages:{required:{error:"Password cannot be blank",success:"Ok"},minlength:{error:"Must be longer than 5 character",success:"Ok"}}},confpasswd:{validations:'match=[name="passwd"]',"validate-on":"blur",messages:{match:{error:"Password and confirm password did not match",success:"Ok"}}}})}}();angular.module("yamaAdminApp").config(["validationSchemaProvider",a])}).call(this);
(function(){var a;a=function(){return function(a){this.menus=[{menu:"Admin",icon:"gears",ref:"app.admin"}];this.state=a;a.go("app.admin")}}();angular.module("yamaAdminApp").controller("appController",["$state",a]);"use strict";a=function(){return function(a){a.state("app",{url:"/",templateUrl:"app/app.html",controller:"appController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a,f;f=function(){return function(a,f,d){return{request:function(a){d.get()&&(a.headers.Authorization="Bearer "+d.get().access_token);return a},responseError:function(d){401===d.status&&a.$broadcast("oauth:unauthorized",d);return f.reject(d)}}}}();a=function(){return function(a){a.interceptors.push("OauthInterceptor")}}();angular.module("yamaAdminApp").factory("OauthInterceptor",["$rootScope","$q","AccessToken",f]).config(["$httpProvider",a]);"use strict";a=function(){return function(){var a,
f,d,g,c,e,b,l;e=c=d=g=f=a=null;b={clientId:"",redirectUri:location.protocol+"//"+location.host,site:location.protocol+"//"+location.host,authorizePath:"/oauth/authorize",tokenPath:"/oauth/token",responseType:"token",state:null,scope:null,storage:"sessionStorage"};l=function(b){a=b.get("$rootScope");f=b.get("$timeout");g=b.get("Endpoint");d=b.get("AccessToken");c=b.get("Storage");c.use(e.storage);g.set(e);d.set(e);return a.$on("oauth:expired",function(){return d.destroy()})};this.configure=function(a){if(!(a instanceof
Object))throw new TypeError("Config must be object");return e=angular.extend({},b,a)};this.login=function(){d.destroy();return g.redirect()};this.logout=function(){d.destroy();return f(function(){return a.$broadcast("oauth:logout")},500)};this.isAuthorized=function(){return!(null===d.get()||d.expired())};this.getAccessToken=function(){return d.get()};this.isExpired=function(){return d.expired()};this.$get=["$injector",function(a){l(a);return{login:this.login,logout:this.logout,isAuthorized:this.isAuthorized,
getAccessToken:this.getAccessToken,isExpired:this.isExpired}}]}}();angular.module("yamaAdminApp").provider("oauth",[a])}).call(this);
(function(){var a,f;a=function(){return function(a){a.configure({site:"http://yama2.meruvian.org",scope:"read write",clientId:"ca4bde63-9a81-4202-b869-69041f5d9217",redirectUri:"http://dianw.github.io/yama-admin"})}}();f=function(){return function(a){a.setBaseUrl("http://yama2.meruvian.org/api")}}();angular.module("yamaAdminApp").config(["oauthProvider",a]).config(["RestangularProvider",f])}).call(this);
(function(){var a;a=function(){return function(a,h,k,d,g){var c,e,b;c=this;g.one("me").get().then(function(a){c.user=a;c.username=c.user.username;return c.email=c.user.email});b=function(a){h.currentUser=a;return d.alert("Update success")};e=function(){return c.error=!0};this.submit=function(d,h){return a.validate(h).success(function(){c.error=!1;return d.id?d.put().then(b,e):g.post(d).then(b,e)})}}}();angular.module("yamaAdminApp").controller("basicProfileController",["$validation","$rootScope",
"$timeout","angularPopupBoxes","RestUserService",a]);"use strict";a=function(){return function(a){a.state("app.profile.basic",{url:"/basic",templateUrl:"profile/basic/basic.form.html",controller:"basicProfileController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a;a=function(){return function(a,h,k){var d;d=this;d.user=k.one("me");this.submit=function(g,c){return a.validate(c).success(function(){d.error=!1;return g.post("password").then(function(a){h.alert("Update success");d.user=a;return d.confirmPassword=a.password},function(){return d.error=!0})})}}}();angular.module("yamaAdminApp").controller("passwdProfileController",["$validation","angularPopupBoxes","RestUserService",a]);"use strict";a=function(){return function(a){a.state("app.profile.passwd",
{url:"/passwd",templateUrl:"profile/passwd/passwd.form.html",controller:"passwdProfileController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a;a=function(){return function(a){var h;h=this;this.photos=[];this.photos.push({photoUrl:a.getPhotoUrl()});this.upload=function(k){return a.uploadPhoto(k,function(){},function(){h.photos.shift();return h.photos.push({photoUrl:a.getPhotoUrl()+"&cache="+(new Date).getTime()})})}}}();angular.module("yamaAdminApp").controller("pictureProfileController",["ProfilePictureService",a]);"use strict";a=function(){return function(a){a.state("app.profile.picture",{url:"/picture",templateUrl:"profile/picture/picture.form.html",
controller:"pictureProfileController as ctrl"})}}();angular.module("yamaAdminApp").config(["$stateProvider",a])}).call(this);
(function(){var a;a=function(){return function(a){this.menus=[{menu:"Basic",icon:"user",ref:"app.profile.basic"},{menu:"Password",icon:"key",ref:"app.profile.passwd"},{menu:"Profile Picture",icon:"camera-retro",ref:"app.profile.picture"}];this.state=a;this.state.go(this.menus[0].ref)}}();angular.module("yamaAdminApp").controller("profileController",["$state",a]);"use strict";a=function(){return function(a){a.state("app.profile",{url:"profile",templateUrl:"profile/profile.html",controller:"profileController as ctrl"})}}();
angular.module("yamaAdminApp").config(["$stateProvider",a]);"use strict";a=function(){return function(a,h,k){return{uploadPhoto:function(d,g,c,e){var b;b=a.one("me").one("photo").getRequestedUrl();return h.http({url:b,data:d,headers:{"Content-Type":d.type}}).progress(g).success(c).error(e)},getPhotoUrl:function(){return a.one("me").one("photo").getRequestedUrl()+"?access_token="+k.getAccessToken().access_token}}}}();angular.module("yamaAdminApp").factory("ProfilePictureService",["RestUserService",
"Upload","oauth",a])}).call(this);
